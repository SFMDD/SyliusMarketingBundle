services:
  fmdd.event.listener.marketing.abstract:
    class: FMDD\SyliusMarketingPlugin\EventListener\AbstractMarketingListener
    abstract: true
    arguments:
      - "@sylius.context.channel"


  fmdd.event.listener.marketing:
    parent: "fmdd.event.listener.marketing.abstract"
    class: FMDD\SyliusMarketingPlugin\EventListener\MarketingListener
    tags:
      - { name: kernel.event_listener, event: sonata.block.event.sylius.shop.layout.head, method: buildLayoutHeader }
      - { name: kernel.event_listener, event: sonata.block.event.sylius.shop.checkout.complete.after_steps, method: buildAddPaymentInfo }
      - { name: kernel.event_listener, event: sonata.block.event.sylius.shop.product.index.after_box, method: buildBoxProduct }
      - { name: kernel.event_listener, event: sonata.block.event.sylius.shop.checkout.address.after_steps, method: buildCheckoutBegin }
      - { name: kernel.event_listener, event: sonata.block.event.sylius.shop.order.thank_you.after_message, method: buildPurchase }
      - { name: kernel.event_listener, event: sonata.block.event.fmdd.event.marketing.checkout_progress, method: buildCheckoutProgress }
      - { name: kernel.event_listener, event: sonata.block.event.fmdd.event.marketing.exception, method: buildException }
      - { name: kernel.event_listener, event: sonata.block.event.fmdd.event.marketing.metadata, method: buildMetadata }
      - { name: kernel.event_listener, event: sonata.block.event.fmdd.event.marketing.product_index, method: buildProductIndex }
      - { name: kernel.event_listener, event: sonata.block.event.fmdd.event.marketing.product_show, method: buildProductShow }
      - { name: kernel.event_listener, event: sonata.block.event.fmdd.event.marketing.product_show_metadata, method: buildProductShowMetadata }
      - { name: kernel.event_listener, event: sonata.block.event.fmdd.event.marketing.promotion, method: buildPromotion }
      - { name: kernel.event_listener, event: sonata.block.event.fmdd.event.marketing.registration, method: buildRegistration }
      - { name: kernel.event_listener, event: sonata.block.event.fmdd.event.marketing.search, method: buildSearch }
      - { name: kernel.event_listener, event: sonata.block.event.fmdd.event.marketing.selectPayment, method: buildSelectPayment }
      - { name: kernel.event_listener, event: sonata.block.event.fmdd.event.marketing.view_item_list, method: buildViewItemList }

  fmdd.event.listener.notification_order_payed:
    class: FMDD\SyliusMarketingPlugin\EventListener\NotificationOrderPayedListener
    arguments: ['@doctrine', '@liip_imagine.cache.manager']
    public: true