{# Produit #}
{% if product is defined %}
    {% if product.imagesByType('thumbnail') is not empty %}
        {% set path = product.imagesByType('thumbnail').first.path|imagine_filter(filter|default('sylius_shop_product_thumbnail')) %}
    {% elseif product.images.first %}
        {% set path = product.images.first.path|imagine_filter(filter|default('sylius_shop_product_thumbnail')) %}
    {% else %}
        {% set path = '//placehold.it/200x200' %}
    {% endif %}
    <script type="application/ld+json">
    {
      "@context": "http://schema.org/",
      "@type": "Product",
      "name": "{{ product.name|lower }}",
      "image": "{{ path }}",
{% if product.shortDescription != null and product.shortDescription != "-" and product.shortDescription != "" %}
      "description": "{{ product.shortDescription }}",
{% else %}
      "description": "{{ product.description|truncate(150, true)  }}",
{% endif %}
      "brand": "{{ website_name|capitalize }}",
      "sku": "{{ product.code|upper }}",
      {% if product.averageRating|round > 0 %}
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "{{ product.averageRating|round }}",
        "reviewCount": "{{ product.acceptedReviews|length }}"
        }
        {% else %}
       "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "4.9",
        "reviewCount": "1"
        }
        {% endif %}
      }
</script>
{% endif %}
