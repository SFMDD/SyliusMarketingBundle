<!-- MARKETING DIGITAL -->
{% include '@SyliusUi/_javascripts.html.twig' with {'path': 'https://cdn.jsdelivr.net/gh/AmauriC/tarteaucitron.js@master/tarteaucitron.js'} %}
<style>#tarteaucitron #tarteaucitronInfo, #tarteaucitron #tarteaucitronServices .tarteaucitronDetails {  position: relative!important; max-width: none; }</style>
<script type="text/javascript">
    tarteaucitronForceCDN = 'https://cdn.jsdelivr.net/gh/AmauriC/tarteaucitron.js@master/';
    tarteaucitron.init({
        "privacyUrl": "{{ sylius.channel.urlPrivacy }}", /* Privacy policy url */

        "hashtag": "#tarteaucitron", /* Open the panel with this hashtag */
        "cookieName": "tarteaucitron", /* Cookie name */

        "orientation": "bottom", /* Banner position (top - bottom) */
        "showAlertSmall": false, /* Show the small banner on bottom right */
        "cookieslist": true, /* Show the cookie list */

        "adblocker": false, /* Show a Warning if an adblocker is detected */
        "AcceptAllCta" : true, /* Show the accept all button when highPrivacy on */
        "highPrivacy": false, /* Disable auto consent */
        "handleBrowserDNTRequest": false, /* If Do Not Track == 1, disallow all */
        "removeCredit": true, /* Remove credit link */
        "moreInfoLink": true, /* Show more info link */
        "useExternalCss": false, /* If false, the tarteaucitron.css file will be loaded */

        //"cookieDomain": ".my-multisite-domaine.fr", /* Shared cookie for multisite */
        "readmoreLink": "/cookiespolicy" /* Change the default readmore link */
    });

    // google analytics
    tarteaucitron.services.analyticsrgpd = {
        "key": "analyticsrgpd",
        "type": "analytic",
        "name": "Google Analytics (send IP)",
        "uri": "https://support.google.com/analytics/topic/2919631",
        "needConsent": true,
        "cookies": ['_ga', '_gat', '_gid', '__utma', '__utmb', '__utmc', '__utmt', '__utmz'],
        "js": function () {
            "use strict";
            if(typeof window.ga === 'undefined') {
                window.GoogleAnalyticsObject = 'ga';
                window.ga = window.ga || function () {
                    window.ga.q = window.ga.q || [];
                    window.ga.q.push(arguments);
                };
                window.ga.l = new Date();

                tarteaucitron.addScript('//www.google-analytics.com/analytics.js', '', function () {
                    ga('create', tarteaucitron.user.analyticsUa, {'cookieExpires': 34128000});
                    ga('send', 'pageview');
                    if (typeof tarteaucitron.user.analyticsMore === 'function') {
                        tarteaucitron.user.analyticsMore();
                    }
                });
            } else {
                ga('set', 'anonymizeIp', false);
            }

        },
        "fallback": function () {
            "use strict";
            var id = 'analyticsrgpd';

            if(typeof window.ga === 'undefined') {

                window.GoogleAnalyticsObject = 'ga';
                window.ga = window.ga || function () {
                    window.ga.q = window.ga.q || [];
                    window.ga.q.push(arguments);
                };
                window.ga.l = new Date();

                tarteaucitron.addScript('//www.google-analytics.com/analytics.js', '', function () {
                    ga('create', tarteaucitron.user.analyticsUa, {'cookieExpires': 34128000});
                    ga('send', 'pageview');
                    ga('set', 'anonymizeIp', true); // anonymisation
                    if (typeof tarteaucitron.user.analyticsMore === 'function') {
                        tarteaucitron.user.analyticsMore();
                    }
                });
            } else {
                ga('set', 'anonymizeIp', true);
            }
        }
    };

    tarteaucitron.user.analyticsUa = '{{ sylius.channel.googleAnalytics }}';
    (tarteaucitron.job = tarteaucitron.job || []).push('analyticsrgpd');

    <!-- Google Analytics + Adwords -->
    tarteaucitron.user.gtagUa = '{{ sylius.channel.googleAnalytics }}';
    {% set google_adwords = sylius.channel.googleAdwords %}
    {% if google_adwords is not empty %}
        tarteaucitron.user.gtagMore = function () {
                <!-- Global site tag (gtag.js) - Google Ads:  -->
                gtag('config', '{{ google_adwords }}');
        };
        (tarteaucitron.job = tarteaucitron.job || []).push('gtag');
    {% endif %}

    {% set facebook_pixel = sylius.channel.facebookPixel %}
    {% if facebook_pixel is not empty %}
        <!-- Pixel Facebook -->
        tarteaucitron.user.facebookpixelId = '{{ facebook_pixel }}';
        tarteaucitron.user.facebookpixelMore = function () {};
        (tarteaucitron.job = tarteaucitron.job || []).push('facebookpixel');
    {% endif %}
</script>

{% include '@FMDDSyliusMarketingPlugin/Include/_functions.html.twig' %}
<!-- END MARKETING DIGITAL -->
